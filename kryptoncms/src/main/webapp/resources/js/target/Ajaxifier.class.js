define(["jquery","libraries/mootools-base","libraries/jquery.history","FormSerializer.class","SocketHandler.class"],function(e,t,n,r){var i=new t.Class({initialize:function(t,i){this.pageScopeMain=t,this.collectGarbage=i,this.formSerializer=new r;if(!n.enabled)return!1;n.Adapter.bind(window,"statechange",e.proxy(function(){var t=n.getState();n.log(t.data,t.title,t.url),e(".dropdown.open").removeClass("open"),this.loadDynamicContent(t.url,this.pageScopeMain,this.collectGarbage)},this))},loadDynamicContent:function(t,n,r){e("#loading_image").slideDown(50);var i=400;e(".inner-body").slideUp(i),e.get(t).always(function(t){typeof t!="string"&&(t=t.responseText),e(".inner-body").html(t).slideDown(i),r(),n(),e("#loading_image").slideUp(50)})},pushState:function(e,t,r){n.pushState(e,t,r)},reload:function(){this.loadDynamicContent(window.location.href,this.pageScopeMain,this.collectGarbage)},passiveReload:function(){this.pageScopeMain()},formSubmitHandler:function(e,t){var n=this;e.submit(function(r){r.preventDefault();var i=n.formSerializer.serialize(e);console.log(i);var i=JSON.stringify(i),s={className:e.attr("className"),actualEntity:i,action:"modify"},o=JSON.stringify(s);return t.push(o),e.parents(".modal[aria-hidden=false]").modal("hide"),!1})}});return i.self=null,i.getInstance=function(e,t){if(i.self==null){if(typeof e=="undefined"||typeof t=="undefined")throw new Error("Ajaxifier Singleton was not previously configured");i.self=new i(e,t)}return i.self},i});