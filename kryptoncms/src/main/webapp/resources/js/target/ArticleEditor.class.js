define(["jquery","libraries/mootools-base","FormSerializer.class","Ajaxifier.class","Notifier.class"],function(e,t,n,r,i){var s=new t.Class({initialize:function(){e("#article_form").submit(function(){var t=e(this),s=t.attr("action");for(instance in CKEDITOR.instances)CKEDITOR.instances[instance].updateElement();e("textarea").trigger("keyup"),e.ajax({dataType:"json",cache:!1,contentType:"application/json",data:JSON.stringify(n.getInstance().serialize(t)),type:t.attr("method"),url:s}).success(function(e){if(e.successful){var t=e.id;s.match(new RegExp("(edit(/)?)$"))!=null&&(s.match(new RegExp("\\w$"))&&(s+="/"),s.match(new RegExp("/$"))&&(s+=t)),s===window.location.pathname?r.getInstance().reload():r.getInstance().pushState({},"Article",s)}else i.getInstance().notify("Something Went Wrong","FAST","VERY_FAST","alert-error")}).fail(function(){}).always(function(){})})}});return s});