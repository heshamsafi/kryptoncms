define(["jquery","libraries/mootools-base"],function(e,t){var n=new t.Class({menu:e(),Implements:[t.Options],initialize:function(){document.oncontextmenu=function(){return!1}},openMenu:function(t,n){var r=this,s={offset:{top:t.pageY,left:t.pageX},items:n};e.when(r.closeMenu()).promise().then(function(){r.menu.remove(),r.menu=e("#context-menu-templ").tmpl(s).appendTo(e(t.target)).slideDown(200);var n=r.menu.parent().parent();for(i in s.items)r.menu.find("li["+s.items[i].dataAttributes+"]").attr("data-context-menu-item-index",i).click(function(){s.items[parseInt(e(this).attr("data-context-menu-item-index"))].callback(n)});e(document).click(e.proxy(r.closeMenu,r))})},closeMenu:function(){var e=this;return e.menu.slideUp(100)}});return n});